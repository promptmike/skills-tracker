# Defensive Security Intro

## Task 1 - Introduction to Defensive Security

In the previous room we learned how to exploit vulnerabilities.
We are now moving on to defending against exploiters.

We will now learn how Blue Teams prevent, detect and respond to intrusions.
Defence requires both preventing intrusions and detecting and responding to them when they occur.

Document assets, patch regularly, install preventions like Intrusion Prevention Systems (IPS) and firewalls, log events and train users.
Blue Teaming requires proper management of every level of the security landscape.

We cover Security Operations Centres (SOC), Threat Intelligence, Digital Forensics and Incident Response (DFIR) and Malware Analysis.
Defensive Security requires prevention, detection and response for every layer of the security landscape.

## Task 2 - Areas of Defensive Security

We will cover Threat Intelligence in the context of a SOC and Malware Analysis in the context of DFIR.
Perform Operations and Analysis to keep all assets documented, patched, protected and monitored while training users.

### Security Operations Center (SOC)

A SOC is a team of Cyber Security professionals who monitor a network to detect intrusions.
Constantly document, monitor, patch and protect all assets on your network while training users.

SOCs watch for Vulnerabilities and apply patches to fix them in good time.
Consistent observation of an entire network and it's weaknesses allows proper timely response.

SOCs monitor Policy Violations that could leave a network vulnerable (e.g. uploading confidential data to cloud storage).
Consistent observation of the network and enforcement of secure practices prevents vulnerability.

SOCs detect Unauthorised Access so they can respond to it as soon as possible, mitigating damage.
Consistent network monitoring, maintenance and enforcement of secure practices allows fast response and loss prevention.

SOCs detect Network Intrusions and respond to them quickly to minimise damage.
Consistent network monitoring, maintenance and enforcement of secure practices permits detection and mitigation of vulnerabilities.

One task that SOCs must do is Threat Intelligence.
A SOC monitors assets on a network, patches regularly and enforces secure practices to prevent, detect and mitigate threats quickly.

#### Threat Intelligence

Threat Intelligence refers to the information you gather about your actual and potential attackers.
SOC must continually collect Threat Intelligence and respond to it with patching, monitoring, policy and response to detected threats.

Data is collected from local sources (e.g. network logs) and public sources (e.g. forums), formatted and analysed for Threat Intel.
SOC gathers data from local and public sources to produce Threat Intelligence that informs their prevention, detection and response.

Learning about your adversaries allows you to prepare, detect and respond to their attacks more effectively.
SOC gathers local and public data to produce Threat Intelligence and take appropriate prevention, detection and response measures.

### Digital Forensics and Incident Response (DFIR)

We will cover Digital Forensics, Incident Response and Malware Analysis.
Threat Intelligence must be combined with Digital Forensics and Incident Response (DFIR) to achieve a strong security position.

#### Digital Forensics

Digital Forensics is the application of science to study computer crimes and establish facts.
Security Analysts must apply scientific methods to establish facts while studying actual and potential threats.

Digital Forensics may involve investigating many actions, such as cyber attacks, IP theft, espionage or illegal possession of content.
Study actual and potential threats with local and public data while gathering new data on areas of interest using scientific methods.

A File System Image (low-level copy) may reveal information on both extant and deleted files and programs.
Study threat actors and analyse data at every level using scientific methods to prepare security policy and response.

Forensic (low-level) copies of memory can reveal malicious software that is run without being saved to disk.
Forensic data from every hardware component must be combined with Threat Intelligence to develop security preparation and response.

Log Files can reveal traces of an attack even after the attacker makes an effort to cover their tracks.
Forensic data must be gathered from the whole range of hardware and software and combined with proper Threat Intelligence.

Network Logs may contain suspicious packets that reveal an ongoing attack.
Hardware and software accross the whole network must be studied forensically alongside Threat Intelligence data.

#### Incident Response

*Incident* refers not only to attacks, but to all insecure events such as policy violations or misconfigurations.
Forensic data, Threat Intelligence and Incident Response all contribute to strong security.

There are four main stages of Incident Response.
Forensic data, Threat Intelligence and the full range of Incident Response actions are vital to strong security.

The first phase of Incident Response is preparation, which includes both preventing potential incidents and training responders.
Prevent Incidents while preparing responses to them informed by Threat Intelligence and Digital Forensics.

The second phase of Incident Response is Detection and Analysis, in which an Incident is studied to develop the proper response.
Use Threat Intelligence and Digital Forensics to prevent and prepare for Incidents, then detect and study them.

The third phase of Incident Response is Containment, Eradication and Recovery.
Contain and Eradicate threats and Recover systems with a strategy informed by Threat Intelligence and Digital Forensics.

The fourth phase of Incident Response is Post Incident Activity, in which a report is produced to help prevent similar incidents.
Prepare defenses informed by data, detect and study threats, contain them, eradicate them, recover systems and learn from incidents.

#### Malware Analysis

Malicious Software (Malware) is a harmful program or file that can be saved to disk or sent over a network.
Prepare defenses informed by data, detect and respond to threats, recover systems and guard against malware.

A virus is a piece of malicious code that attaches itself to a program to alter, overwrite or delete files and spread itself.
Analyse data to prepare, detect and respond to threats and recover systems from malware such as viruses.

A Trojan Horse is a program that offers a useful service while hiding a malicious action.
Analyse data to prepare, detect and respond to threats and recover systems from malware such as Trojan horses.

Ransomware is a malicious program that encrypts files and demands payment for decryption.
Prevent and prepare for threats such as malware by developing a detection and response strategy informed by data.

Malware Analysis is the practice of learning about suspicious programs.
Analyse threats to inform a preparation, detection and response strategy.

Static Malware Analysis works by studying the Assembly code without running it.
Analyse threats at every level to inform a preparation, detection and response strategy.

Dynamic Malware Analysis works by running Malware in a controlled environment to observe its behaviour.
Forensically analyse Incidents across the network and gather Threat Intelligence to inform a prevention, detection and response strategy.

## Task 3 - Practical Example of Defensive Security

### The Scenario

Pretend you are a SOC Analyst watching a Security Information and Event Management (SIEM) dashboard.
Conduct DFIR and use tools such as SIEMs for SOC Analysis to develop Threat Intelligence and prepare a security response.

As a SOC Analyst you must determine which alerts are harmful.
Conduct Digital Forensics and Analyse alerts on your SIEM to develop Threat Intelligence and informed Incident Response.

Some alerts are harmless mistakes such as a user forgetting their password.
Develop Threat Intelligence and discern harmful Incidents to inform DFIR.

An unknown IP address could be a new user or a malicious attacker.
Develop Threat Intelligence and identify the nature of Incidents to inform DFIR.

### Simulating a SIEM

THM offers virtual SIEMs to practice detection, analysis and response.
Practice developing Threat Intelligence and identifying the nature of Incidents in a safe environment and learn to inform DFIR.

The View Site button starts the virtual SIEM.
Practice developting Threat Intelligence and identifying the nature of Incidents safely on a remote machine to learn how to inform DFIR.

The Static Site contains a flag for you to capture.
Practice Threat Intelligence and SOC Analysis of Incidents in safe CTF challenges to learn how to inform DFIR operations.

### What's next?

The information covered here is the foundation of Blue Teaming.
Practice Threat Intelligence, SOC Analysis, DFIR and Malware Analysis in safe CTF challenges as the foundation for Blue Teaming.

The room Search Skills is recommended as the next step.
Continue to practice Threat Intelligence, SOC Analysis, DFIR, Malware Analysis and other foundational skills in a safe CTF environment.